const express=require('express');const router=express.Router();const User=require('../models/User');router.post('/accept',async(req,res)=>{try{const userId=req.body.userId||(req.user&&req.user._id);if(!userId) return res.status(400).json({ok:false,error:'Missing userId'});const user=await User.findByIdAndUpdate(userId,{indemnityAccepted:true,indemnityAcceptedAt:new Date()},{new:true});res.json({ok:true,indemnityAccepted:user.indemnityAccepted});}catch(e){console.error(e);res.status(500).json({ok:false,error:'Server error'});}});module.exports=router;